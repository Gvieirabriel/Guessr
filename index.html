<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NoiseGuessr</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; padding: 20px; }
        .hidden { display: none; }
    </style>
</head>
<body>
    <h1>🔊 NoiseGuessr</h1>
    <p>Ouça o som e tente adivinhar de onde ele vem!</p>
    <button id="playSound">🔊 Reproduzir Som</button>
    <div id="choices"></div>
    <p id="result"></p>
    
    <script>
        const API_KEY = 'SUA_CHAVE_AQUI';
        const STORAGE_KEY = 'echoGuessrSound';
        const choicesDiv = document.getElementById('choices');
        const resultText = document.getElementById('result');
        let soundData;
        
        async function fetchSoundOfTheDay() {
            const today = new Date().toISOString().split('T')[0]; // Data YYYY-MM-DD
            const storedData = JSON.parse(localStorage.getItem(STORAGE_KEY));
            
            if (storedData && storedData.date === today) {
                soundData = storedData;
            } else {
                try {
                    const response = await fetch(`https://freesound.org/apiv2/sounds/96541/?token=${API_KEY}`);
                    const data = await response.json();
                    soundData = {
                        date: today,
                        url: data.previews['preview-hq-mp3'],
                        correctAnswer: 'Porta rangendo', // Simulação, podemos tornar dinâmico depois
                        options: ['Porta rangendo', 'Gato miando', 'Moto acelerando', 'Pássaros cantando']
                    };
                    localStorage.setItem(STORAGE_KEY, JSON.stringify(soundData));
                } catch (error) {
                    console.error('Erro ao buscar som:', error);
                }
            }
        }
        
        function setupGame() {
            if (!soundData) return;
            
            const audio = new Audio(soundData.url);
            document.getElementById('playSound').addEventListener('click', () => {
                audio.play();
            });
            
            choicesDiv.innerHTML = '';
            soundData.options.forEach(option => {
                const btn = document.createElement('button');
                btn.textContent = option;
                btn.onclick = () => checkAnswer(option);
                choicesDiv.appendChild(btn);
            });
        }
        
        function checkAnswer(choice) {
            if (choice === soundData.correctAnswer) {
                resultText.textContent = '✅ Correto!';
            } else {
                resultText.textContent = `❌ Errado! A resposta era: ${soundData.correctAnswer}`;
            }
        }
        
        fetchSoundOfTheDay().then(setupGame);
    </script>
</body>
</html>
